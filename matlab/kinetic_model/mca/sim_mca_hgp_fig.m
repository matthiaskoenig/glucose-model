function [] = sim_mca_hgp_fig(data, glc, glycogen, name, fname);
N_glc = numel(glc);
N_glycogen = numel(glycogen);
n1_names = cell(N_glycogen, 1);
for k=1:N_glycogen
   n1_names{k} = horzcat('glycogen ', num2str(glycogen(k)), ' mM');
end

cmap = [0.0416666679084301 0 0;0.0833333358168602 0 0;0.125 0 0;0.16666667163372 0 0;0.20833332836628 0 0;0.25 0 0;0.291666656732559 0 0;0.333333343267441 0 0;0.375 0 0;0.416666656732559 0 0;0.458333343267441 0 0;0.5 0 0;0.541666686534882 0 0;0.583333313465118 0 0;0.625 0 0;0.666666686534882 0 0;0.708333313465118 0 0;0.75 0 0;0.791666686534882 0 0;0.833333313465118 0 0;0.875 0 0;0.916666686534882 0 0;0.958333313465118 0 0;1 0 0;1 0.0416666679084301 0;1 0.0833333358168602 0;1 0.125 0;1 0.16666667163372 0;1 0.20833332836628 0;1 0.25 0;1 0.291666656732559 0;1 1 1;1 1 1;1 0.416666656732559 0;1 0.458333343267441 0;1 0.5 0;1 0.541666686534882 0;1 0.583333313465118 0;1 0.625 0;1 0.666666686534882 0;1 0.708333313465118 0;1 0.75 0;1 0.791666686534882 0;1 0.833333313465118 0;1 0.875 0;1 0.916666686534882 0;1 0.958333313465118 0;1 1 0;0.9375 0.968627452850342 0;0.875 0.937254905700684 0;0.8125 0.905882358551025 0;0.75 0.874509811401367 0;0.6875 0.843137264251709 0;0.625 0.811764717102051 0;0.5625 0.780392169952393 0;0.5 0.749019622802734 0;0.4375 0.717647075653076 0;0.375 0.686274528503418 0;0.3125 0.65490198135376 0;0.25 0.623529434204102 0;0.1875 0.592156887054443 0;0.125 0.560784339904785 0;0.0625 0.529411792755127 0;0 0.498039215803146 0];
cmap = [0.0416666679084301 0 0;0.137500002980232 0 0;0.233333334326744 0 0;0.329166680574417 0 0;0.425000011920929 0 0;0.520833313465118 0 0;0.616666674613953 0 0;0.712499976158142 0 0;0.808333337306976 0 0;0.904166638851166 0 0;1 0 0;1 0.0909090936183929 0;1 0.181818187236786 0;1 0.272727280855179 0;1 0.363636374473572 0;1 0.454545468091965 0;1 0.545454561710358 0;1 0.636363625526428 0;1 0.727272748947144 0;1 0.818181812763214 0;1 0.909090936183929 0;1 1 0;1 1 0.100000001490116;1 1 0.200000002980232;1 1 0.300000011920929;1 1 0.400000005960464;1 1 0.5;1 1 0.600000023841858;1 1 0.699999988079071;1 1 0.800000011920929;1 1 0.899999976158142;1 1 1;1 1 1;0.923076927661896 0.961387634277344 0.923076927661896;0.846153855323792 0.922775268554688 0.846153855323792;0.769230782985687 0.884162902832031 0.769230782985687;0.692307710647583 0.845550537109375 0.692307710647583;0.615384638309479 0.806938171386719 0.615384638309479;0.538461565971375 0.768325805664062 0.538461565971375;0.461538463830948 0.729713439941406 0.461538463830948;0.384615391492844 0.69110107421875 0.384615391492844;0.307692319154739 0.652488708496094 0.307692319154739;0.230769231915474 0.613876342773438 0.230769231915474;0.15384615957737 0.575263977050781 0.15384615957737;0.0769230797886848 0.536651611328125 0.0769230797886848;0 0.498039215803146 0;0 0.470370382070541 0.0555555559694767;0 0.442701518535614 0.111111111938953;0 0.415032684803009 0.16666667163372;0 0.387363821268082 0.222222223877907;0 0.359694987535477 0.277777791023254;0 0.332026153802872 0.333333343267441;0 0.304357290267944 0.388888895511627;0 0.276688456535339 0.444444447755814;0 0.249019607901573 0.5;0 0.221350759267807 0.555555582046509;0 0.193681910634041 0.611111104488373;0 0.166013076901436 0.666666686534882;0 0.13834422826767 0.722222208976746;0 0.110675379633904 0.777777791023254;0 0.0830065384507179 0.833333313465118;0 0.0553376898169518 0.888888895511627;0 0.0276688449084759 0.944444417953491;0 0 1];
I_v_rem = [10 12 24 33:36];

for k=1:N_glc
    fig1 = figure('Colormap', cmap, 'Color', [1 1 1], 'Position', [0 1600 800 800]);
    %subplot(1, N_glc, k);
    
    C = data(((k-1)*N_glycogen+1):k*N_glycogen, :) ;
    n2_names = names_v();
    
    C(:, I_v_rem) = [];
    n2_names(I_v_rem) = [];
    
    [n1, n2] = size(C);
    C = [C zeros(n1,1); [zeros(1,n2) -1]];
    X = 0.5:1:n2+0.5;
    Y = 0.5:1:n1+0.5;
    pcolor(X, Y, C) %colormap('hot')
    colorbar()
    title(horzcat(name, ' - ', num2str(glc(k)), 'mM glucose'));
    set(gca, 'YTick', 1:n1) 
    set(gca,'YTickLabel',n1_names())
    set(gca, 'XTick', 1:n2) 
    xticklabel_rotate90(1:n2, n2_names())
    %set(gca,'Ydir','reverse')
    caxis([-3 3])
    axis('square')
    set(gca, 'XAxisLocation', 'bottom')
    bold_subplots()
    scale_subplots(0.7)
    
    %saveas(fig1, strcat('mca_test_', fname, num2str(glc(k))', '.tif'))
    print(fig1, strcat('mca_test_', fname, num2str(glc(k))', '.tiff'), '-r300', '-dtiff')
end


%%%%%