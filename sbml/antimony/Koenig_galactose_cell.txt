//Created by libAntimony v2.4
/*      ------------------------------------------------
	Human Hepatic Galactose Metabolism
	------------------------------------------------
	The model consists of the main reaction of galactose metabolism
	and additional surrounding reaction.

	The model includes a normal model (deficiency = 0), as well as
        models for galactosemias (GALK, GALT & GALE deficiencies) which
	can be selected by setting the deficiency parameter to the respective
        values of the deficiencies.

	GALK deficiency: 1 <= deficiency <= 8
	GALT deficiency: 9 <= deficiency <= 14
	GALE deficiency: 15<= deficiency <= 23

	Layout:	
	     ------------
	    | disse      |
	     ------------
	    | hepatocyte |
             ------------
	
	Matthias König - 2013-09-24
	Copyright © Matthias König 2013 All Rights Reserved.
*/

model *Koenig2013_galactose()
  // Units
  unit substance = 1e-3 mole;
  unit volume = litre;
  unit area = metre^2; 
  unit length = metre;
  //unit time = second; // not working

  unit mM = 1e-3 mole / litre;
  unit per_mM = litre / 1e-3 mole;
  unit mmol_per_s = 1e-3 mole / second;
  unit per_s = 1 / second;
  unit mmol = 1e-3 mole;

  // Compartments and Species
  compartment disse, hepatocyte, protein;
  disse = 0.2 litre;
  hepatocyte = 1 litre;
  protein = 1 litre;

  species glc_dis in disse, gal_dis in disse, galM_dis in disse;
  species glc in hepatocyte, gal in hepatocyte, galM in hepatocyte;
  species glc1p in hepatocyte, $glc6p in hepatocyte, gal1p in hepatocyte;
  species udpglc in hepatocyte, udpgal in hepatocyte, galtol in hepatocyte;
  species atp in hepatocyte, adp in hepatocyte, utp in hepatocyte, udp in hepatocyte;
  species phos in hepatocyte, ppi in hepatocyte, nadp in hepatocyte, nadph in hepatocyte;

  // Species initializations:
  glc_dis = 5.5 mM;
  gal_dis = 0.0012 mM;
  galM_dis = 0 mM;
  glc = 5.5 mM;
  gal = 0.00012 mM;
  galM =  0 mM;
  glc1p = 0.012 mM;
  glc6p = 0.12 mM;
  gal1p = 0.001 mM;
  udpglc = 0.34 mM;
  udpgal = 0.11 mM;
  galtol = 0.001 mM;
  atp = 2.7 mM;
  adp = 1.2 mM;
  utp = 0.27 mM;
  udp = 0.09 mM;
  phos = 5 mM;
  ppi = 0.008 mM;
  nadp = 0.1 mM;
  nadph = 0.1 mM;

  glc_dis is "D-glucose[disse]";
  gal_dis is "D-galactose[disse]";
  galM_dis is "D-galactoseM[disse]";
  glc is "D-glucose";
  gal is "D-galactose";
  galM is "D-galactoseM";
  glc1p is "D-glucose 1-phophate";
  glc6p is "D-glucose 6-phosphate";
  gal1p is "D-galactose 1-phosphate";
  udpglc is "UDP-D-glucose";
  udpgal is "UDP-D-galactose";
  galtol is "D-galactitol";
  atp is "ATP";
  adp is "ADP";
  utp is "UTP";
  udp is "UDP";
  phos is "phosphate";
  ppi is "pyrophosphate";
  nadp is "NADP";
  nadph is "NADPH";

  // Assignment rules for balances
  nadp_tot := nadp + nadph;
  atp_tot := atp + adp;
  utp_tot := utp + udp + udpglc + udpgal;
  phos_tot := 3*atp + 2*adp + 3*utp + 2*udp + phos + 2*ppi + glc1p + glc6p + gal1p + 2*udpglc + 2*udpgal;

  /* Simulation of galactose challenge via events */
  EGAL1: at eq(time, 50):  gal_dis = 3 mM;
  EGAL2: at eq(time, 100): gal_dis = 0 mM;

  // Protein initialization (mainly for SBGN)
  REF_P = 1 mM;
  const species GLUT2_P = 1 mM;
  const species GALK_P = 1 mM;
  const species IMP_P = 1 mM;
  const species ATPS_P = 1 mM;
  const species ALDR_P = 1 mM;
  const species NADPR_P = 1 mM;
  const species GALT_P = 1 mM;
  const species GALE_P = 1 mM;
  const species UGP_P = 1 mM;
  const species PPASE_P = 1 mM;
  const species NDKU_P = 1 mM;
  const species PGM1_P = 1 mM;
  const species GTFGAL_P = 1 mM;
  const species GTFGLC_P = 1 mM;

  GLUT2_P is "GLUT2"; 
  GALK_P is "GALK";
  IMP_P is "IMP";
  ATPS_P is "ATPS";
  ALDR_P is "ALDR";
  NADPR_P is "NADPR";
  GALT_P is "GALT";
  GALE_P is "GALE";
  UGP_P is "UGP";
  PPASE_P is "PPASE";
  NDKU_P is "NDKU";
  PGM1_P is "PGM1";
  GTFGAL_P is "GTFGAL";
  GTFGLC_P is "GTFGLC";

  GLUT2_P in protein; 
  GALK_P in protein;
  IMP_P in protein;
  ATPS_P in protein;
  ALDR_P in protein;
  NADPR_P in protein;
  GALT_P in protein;
  GALE_P in protein;
  UGP_P in protein;
  PPASE_P in protein;
  NDKU_P in protein;
  PGM1_P in protein;
  GTFGAL_P in protein;
  GTFGLC_P in protein;


  /* Simulation of galactosemias via events */
  deficiency = 0 dimensionless;

  // model scaling to right size;
  scale = 1e-015 dimensionless;

  // Reactions
  GLUT2_GLC is "GLUT2 (glucose)";
  GLUT2_GAL is "GLUT2 (galactose)";
  GLUT2_GALM is "GLUT2 (galactose M)";
  GALK is "Galactokinase";
  GALKM is "Galactokinase M";
  IMP is "Inositol monophosphatase";
  ATPS is "ATP synthase";
  ALDR is "Aldose reductase";
  NADPR is "NADP reductase";
  GALT is "Galactose-1-phosphate uridyl transferase";
  GALE is "UDP-glucose 4-epimerase";
  UGP is "UDP-glucose pyrophosphorylase";
  UGALP is "UDP-galactose pyrophosphorylase";
  PPASE is "Pyrophosphatase";
  NDKU is "Nucleoside diphosphokinase";
  PGM1 is "Phosphoglucomutase-1";
  GTFGLC is "Glycosyltransferase glucose";
  GTFGAL is "Glycosyltransferase galactose";

  GLUT2_GLC: $glc_dis -> glc; 
  GLUT2_GLC has mmol_per_s;
  pGLUT2_GLC: GLUT2_P -( GLUT2_GLC;

  GLUT2_GAL: $gal_dis -> gal;
  GLUT2_GAL has mmol_per_s;
  pGLUT2_GAL: GLUT2_P -( GLUT2_GAL;

  GLUT2_GALM: $galM_dis -> galM;
  GLUT2_GALM has mmol_per_s;
  pGLUT2_GALM: GLUT2_P -( GLUT2_GALM;

  GALK: gal + atp -> gal1p + adp; 
  GALK has mmol_per_s;
  pGALK: GALK_P -( GALK;

  GALKM: galM + atp => gal1p + adp;
  GALKM has mmol_per_s;
  pGALKM: GALK_P -( GALKM;

  IMP: gal1p => gal + phos;
  IMP has mmol_per_s;
  pIMP: IMP_P -( IMP;

  ATPS: adp + phos -> atp;
  ATPS has mmol_per_s;
  pATPS: ATPS_P -( ATPS;
  
  GALK_Vmax = 1 mmol_per_s;
  ATPS_P = 1 mM;
  ATPS_keq = 0.58 per_mM;
  ATPS_kadp = 0.1 mM;
  ATPS_katp = 0.5 mM;
  ATPS_kphos = 0.1 mM;
  ATPS_Vmax = 20.0*GALK_Vmax * ATPS_P/REF_P;
  ATPS_Vmax has mmol_per_s;
  ATPS = ATPS_Vmax/(ATPS_kadp*ATPS_kphos) *(adp*phos-atp/ATPS_keq)/((1+adp/ATPS_kadp)*(1+phos/ATPS_kphos) + atp/ATPS_katp);
   


  ALDR: gal + nadph -> galtol + nadp;
  ALDR has mmol_per_s;
  pALDR: ALDR_P -( ALDR;
 
  NADPR: nadp -> nadph; 
  NADPR has mmol_per_s;
  pNADPR: NADPR_P -( NADPR;

  GALT: gal1p + udpglc -> glc1p + udpgal;
  GALT has mmol_per_s;
  pGALT: GALT_P -( GALT;

  GALE: udpglc -> udpgal;
  GALE has mmol_per_s;
  pGALE: GALE_P -( GALE;
 
  UGP: glc1p + utp -> udpglc + ppi;
  UGP has mmol_per_s;
  pUGP: UGP_P -( UGP;

  UGALP: gal1p + utp -> udpgal + ppi;
  UGALP has mmol_per_s;
  pUGALP: UGP_P -( UGALP;

  PPASE: ppi => 2phos;
  PPASE has mmol_per_s;
  pPPASE: PPASE_P -( PPASE;

  NDKU: atp + udp -> adp + utp;
  NDKU has mmol_per_s;
  pNDKU: NDKU_P -( NDKU;

  PGM1: glc1p -> $glc6p + phos;
  PGM1 has mmol_per_s;
  pPGM1: PGM1_P -( PGM1;

  GTFGAL: udpgal -> udp;
  GTFGAL has mmol_per_s;
  pGTFGAL: GTFGAL_P -( GTFGAL;

  GTFGLC: udpglc -> udp; 
  GTFGLC has mmol_per_s;
  pGTFGLC: GTFGLC_P -( GTFGLC;

  // Events:
  E1: at eq(deficiency, 1): GALK_kcat = 2 per_s, GALK_k_gal = 7.7 mM, GALK_k_atp = 0.13 mM;
  E2: at eq(deficiency, 2): GALK_kcat = 3.9 per_s, GALK_k_gal = 0.43 mM, GALK_k_atp = 0.11 mM;
  E3: at eq(deficiency, 3): GALK_kcat = 5.9 per_s, GALK_k_gal = 0.66 mM, GALK_k_atp = 0.026 mM;



end
