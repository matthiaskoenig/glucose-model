//Created by libAntimony v2.4
model *Koenig2013_test()

  // Compartments and Species:
  compartment disse, hepatocyte;
  species $gal_dis in disse, gal in hepatocyte, gal1p in hepatocyte, atp in hepatocyte;
  species adp in hepatocyte, galM in hepatocyte;

  // Reactions:
  GALK: gal + atp -> gal1p + adp; 
  GALK = GALK_Vmax/(GALK_k_gal*GALK_k_atp)* 1/(1+gal1p/GALK_ki_gal1p) * (gal*atp - gal1p*adp/GALK_keq) / ((1 + (gal + galM) / GALK_k_gal) * (1 + atp / GALK_k_atp) + (1 + gal1p / GALK_k_gal1p) * (1 + adp / GALK_k_adp) - 1);
  GALK is "Galactokinase";
  GALK has mmol_per_s;

  // Species initializations:
  gal_dis = 5.5;
  gal_dis has mM;
  gal_dis is "D-galactose[disse]";
  gal = 1;
  gal has mM;
  gal is "D-galactose";
  gal1p = 0.05;
  gal1p has mM;
  gal1p is "D-galactose";
  atp = 2;
  atp has mM;
  atp is "ATP";
  adp = 0.8;
  adp has mM;
  adp is "ADP";
  galM = 0;
  galM has mM;
  galM is "D-galactose M";

  // Compartment initializations:
  disse = 0.2;
  disse has litre;
  hepatocyte = 1;
  hepatocyte has litre;

  // Variable initializations:
  deficiency = 0;
  deficiency has dimensionless;
  scale = 1;
  scale has dimensionless;

  GALK_k_atp = 0.034;
  GALK_k_atp has mM;
  GALK_k_gal = 0.97;
  GALK_k_gal has mM;
  GALK_kcat = 8.7;
  GALK_kcat has per_s;
  GALK_Vmax = 0.2 * scale * GALK_P * GALK_kcat;
  GALK_Vmax has mmol_per_s;
  GALK_P = 2;
  GALK_P has mmol;
  GALK_ki_gal1p = 5.3;
  GALK_ki_gal1p has mM;
  GALK_keq = 50;
  GALK_keq has dimensionless;
  GALK_k_gal1p = 1.5;
  GALK_k_gal1p has mM;
  GALK_k_adp = 0.8;
  GALK_k_adp has mM;

  // Events:
  E1: at eq(deficiency, 1): GALK_kcat = 2 per_s, GALK_k_gal = 7.7 mM, GALK_k_atp = 0.13 mM;
  E2: at eq(deficiency, 2): GALK_kcat = 3.9 per_s, GALK_k_gal = 0.43 mM, GALK_k_atp = 0.11 mM;
  E3: at eq(deficiency, 3): GALK_kcat = 5.9 per_s, GALK_k_gal = 0.66 mM, GALK_k_atp = 0.026 mM;



  // Assignment Rules:
  atp_tot := atp + adp;
  atp_tot has mM;

  //Other declarations:
  var GALK_k_atp, GALK_k_gal, GALK_kcat, atp_tot, GALK_Vmax, GALK_dm;
  const disse, hepatocyte, deficiency, scale, GALK_P, GALK_ki_gal1p, GALK_keq;
  const GALK_k_gal1p, GALK_k_adp;

  // Unit definitions:
  unit substance = 1e-3 mole;
  unit volume = litre;
  unit area = metre^2; 
  unit length = metre;
  //unit time = second; // not working

  unit mM = 1e-3 mole / litre;  
  unit mmol_per_s = 1e-3 mole / second;
  unit per_s = 1 / second;
  unit mmol = 1e-3 mole;
end
